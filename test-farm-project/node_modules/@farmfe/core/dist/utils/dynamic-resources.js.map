{"version":3,"file":"dynamic-resources.js","sourceRoot":"","sources":["../../src/utils/dynamic-resources.ts"],"names":[],"mappings":"AAEA,MAAM,UAAU,mBAAmB,CACjC,mBAAsD;IAKtD,IAAI,gBAAgB,GAAsB,IAAI,CAAC;IAC/C,IAAI,yBAAyB,GAAoC,IAAI,CAAC;IACtE,IAAI,UAAU,GAAG,IAAI,GAAG,EAAE,CAAC;IAE3B,IAAI,mBAAmB,EAAE;QACvB,gBAAgB,GAAG,EAAE,CAAC;QACtB,yBAAyB,GAAG,EAAE,CAAC;QAE/B,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,mBAAmB,CAAC,EAAE;YAC9D,KAAK,MAAM,CAAC,IAAI,KAAK,EAAE;gBACrB,MAAM,UAAU,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBACrC,IAAI,UAAU,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;oBAC9B,yBAAyB,CAAC,GAAG,MAA7B,yBAAyB,CAAC,GAAG,IAAM,EAAE,EAAC;oBACtC,yBAAyB,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;oBAChE,SAAS;iBACV;gBACD,gBAAgB,CAAC,IAAI,CAAC;oBACpB,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;oBACV,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;iBAChC,CAAC,CAAC;gBAEH,yBAAyB,CAAC,GAAG,MAA7B,yBAAyB,CAAC,GAAG,IAAM,EAAE,EAAC;gBACtC,yBAAyB,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;gBACjE,UAAU,CAAC,GAAG,CAAC,UAAU,EAAE,gBAAgB,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;aACzD;SACF;KACF;IAED,OAAO,EAAE,gBAAgB,EAAE,yBAAyB,EAAE,CAAC;AACzD,CAAC","sourcesContent":["import type { Resource } from '@farmfe/runtime/src/resource-loader.js';\n\nexport function getDynamicResources(\n  dynamicResourcesMap: Record<string, string[][]> | null\n): {\n  dynamicResources: Resource[] | null;\n  dynamicModuleResourcesMap: Record<string, number[]> | null;\n} {\n  let dynamicResources: Resource[] | null = null;\n  let dynamicModuleResourcesMap: Record<string, number[]> | null = null;\n  let visitedMap = new Map();\n\n  if (dynamicResourcesMap) {\n    dynamicResources = [];\n    dynamicModuleResourcesMap = {};\n\n    for (const [key, value] of Object.entries(dynamicResourcesMap)) {\n      for (const r of value) {\n        const visitedKey = r[0] + '.' + r[1];\n        if (visitedMap.has(visitedKey)) {\n          dynamicModuleResourcesMap[key] ??= [];\n          dynamicModuleResourcesMap[key].push(visitedMap.get(visitedKey));\n          continue;\n        }\n        dynamicResources.push({\n          path: r[0],\n          type: r[1] === 'script' ? 0 : 1\n        });\n\n        dynamicModuleResourcesMap[key] ??= [];\n        dynamicModuleResourcesMap[key].push(dynamicResources.length - 1);\n        visitedMap.set(visitedKey, dynamicResources.length - 1);\n      }\n    }\n  }\n\n  return { dynamicResources, dynamicModuleResourcesMap };\n}\n"]}