{"version":3,"file":"share.js","sourceRoot":"","sources":["../../src/utils/share.ts"],"names":[],"mappings":"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","sourcesContent":["import fs from 'node:fs';\n/* eslint-disable no-prototype-builtins */\nimport os from 'node:os';\nimport path, { dirname } from 'node:path';\nimport readline from 'node:readline';\nimport { fileURLToPath } from 'node:url';\nimport { Config, OutputConfig } from '../types/binding.js';\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore import packageJson from '../../package.json';\n\nconst __dirname = dirname(fileURLToPath(import.meta.url));\n\nconst splitRE = /\\r?\\n/;\n\nexport const FARM_TARGET_NODE_ENVS = [\n  'node',\n  'node16',\n  'node-legacy',\n  'node-next'\n];\nexport const FARM_TARGET_BROWSER_ENVS = [\n  'browser',\n  'browser-legacy',\n  'browser-es2015',\n  'browser-es2017',\n  'browser-esnext'\n];\n\nexport const FARM_TARGET_LIBRARY_ENVS = [\n  'library',\n  'library-node',\n  'library-browser'\n];\n\n/* eslint-disable @typescript-eslint/no-use-before-define */\nexport function isObject(value: unknown): value is Record<string, unknown> {\n  return Object.prototype.toString.call(value) === '[object Object]';\n}\n\nexport function isArray(value: unknown): value is unknown[] {\n  return Array.isArray(value);\n}\n\nexport function isEmptyObject<T extends object>(obj: T): boolean {\n  if (!obj) return true;\n  return Reflect.ownKeys(obj).length === 0;\n}\n\nexport const isUndefined = (obj: any): obj is undefined =>\n  typeof obj === 'undefined';\nexport const isString = (val: any): val is string => typeof val === 'string';\nexport const isNumber = (val: any): val is number => typeof val === 'number';\nexport const isEmpty = (array: any): boolean => !(array && array.length > 0);\nexport const isSymbol = (val: any): val is symbol => typeof val === 'symbol';\n\nexport const isWindows = os.platform() === 'win32';\n\nexport function pad(source: string, n = 2): string {\n  const lines = source.split(splitRE);\n  return lines.map((l) => ` `.repeat(n) + l).join(`\\n`);\n}\n\nexport function clearScreen() {\n  try {\n    const repeatCount = process.stdout.rows - 2;\n    const blank = repeatCount > 0 ? '\\n'.repeat(repeatCount) : '';\n    console.log(blank);\n    readline.cursorTo(process.stdout, 0, 0);\n    readline.clearScreenDown(process.stdout);\n  } catch (error) {\n    console.error('Failed to clear screen:', error);\n  }\n}\n\nexport const version = JSON.parse(\n  fs.readFileSync(path.resolve(__dirname, '../../package.json')).toString()\n).version;\n\nexport function normalizePath(id: string): string {\n  return path.posix.normalize(id);\n}\n\nexport function normalizeBasePath(basePath: string): string {\n  return path.posix.normalize(\n    isWindows ? basePath.replace(/\\\\/g, '/') : basePath\n  );\n}\n\nexport function arraify<T>(target: T | T[]): T[] {\n  return Array.isArray(target) ? target : [target];\n}\n\nexport function getFileSystemStats(file: string): fs.Stats | undefined {\n  try {\n    return fs.statSync(file, { throwIfNoEntry: false });\n  } catch (error) {\n    console.error(`Error accessing file ${file}:`, error);\n    return undefined;\n  }\n}\n\n/**\n * Null or whatever\n */\nexport type Nullable<T> = T | null | undefined;\n\n/**\n * Array, or not yet\n */\nexport type ArrayAble<T> = T | Array<T>;\n\nexport function toArray<T>(array?: Nullable<ArrayAble<T>>): Array<T> {\n  return array ? (Array.isArray(array) ? array : [array]) : [];\n}\n\nexport function mergeObjects<\n  T extends Record<string, any>,\n  U extends Record<string, any>\n>(obj1: T, obj2: U): T & U {\n  const merged: Record<string, any> = { ...obj1 };\n\n  Object.keys(obj2).forEach((key) => {\n    if (Object.prototype.hasOwnProperty.call(obj2, key)) {\n      if (\n        merged.hasOwnProperty(key) &&\n        typeof obj2[key] === 'object' &&\n        !Array.isArray(obj2[key])\n      ) {\n        merged[key] = mergeObjects(merged[key], obj2[key]);\n      } else {\n        merged[key] = obj2[key];\n      }\n    }\n  });\n\n  return merged as T & U;\n}\n\nexport async function asyncFlatten<T>(arr: T[]): Promise<T[]> {\n  do {\n    arr = (await Promise.all(arr)).flat(Infinity) as any;\n  } while (arr.some((v: any) => v?.then));\n  return arr;\n}\n\nexport function sleep(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n// prevent node experimental warning\nexport function preventExperimentalWarning() {\n  const defaultEmit = process.emit;\n  process.emit = function (...args: any[]) {\n    if (args[1].name === 'ExperimentalWarning') {\n      return undefined;\n    }\n    return defaultEmit.call(this, ...args);\n  };\n}\n\nexport function mapTargetEnvValue(config: Config['config']) {\n  if (FARM_TARGET_NODE_ENVS.includes(config.output.targetEnv)) {\n    config.output.targetEnv = 'node';\n  } else if (FARM_TARGET_BROWSER_ENVS.includes(config.output.targetEnv)) {\n    config.output.targetEnv = 'browser';\n  } else {\n    if (FARM_TARGET_LIBRARY_ENVS.includes(config.output.targetEnv)) {\n      return;\n    }\n\n    config.output.targetEnv = 'library-browser';\n  }\n}\n\nexport function tryStatSync(file: string): fs.Stats | undefined {\n  try {\n    return fs.statSync(file, { throwIfNoEntry: false });\n  } catch {}\n}\n\nexport function isNodeEnv(env: OutputConfig['targetEnv']): boolean {\n  return /^(node|library)(?!-browser)/.test(env);\n}\n"]}